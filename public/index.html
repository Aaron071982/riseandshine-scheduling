<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scheduling AI - Client Matching</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'rise-orange': '#FF6B35',
                        'rise-orange-light': '#FF8C5A',
                        'rise-orange-dark': '#E55A2B',
                    }
                }
            }
        }
    </script>
    <script src="config.js"></script>
    <script>
        function initGoogleMaps() {
            if (typeof google !== 'undefined' && google.maps) {
                window.dispatchEvent(new Event('google-maps-loaded'));
            }
        }
        
        function loadGoogleMaps() {
            const apiKey = window.APP_CONFIG?.GOOGLE_MAPS_API_KEY || '';
            if (!apiKey) {
                console.error('Google Maps API key not found in config.js');
                return;
            }
            const script = document.createElement('script');
            script.src = `https://maps.googleapis.com/maps/api/js?key=${apiKey}&libraries=geometry&callback=initGoogleMaps`;
            script.async = true;
            script.defer = true;
            document.head.appendChild(script);
        }
        
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', loadGoogleMaps);
        } else {
            loadGoogleMaps();
        }
    </script>
</head>
<body class="bg-gradient-to-br from-slate-50 to-slate-100">
    <div class="min-h-screen flex flex-col">
        <!-- Header -->
        <header class="bg-white border-b border-slate-200 shadow-sm sticky top-0 z-50">
            <div class="max-w-full mx-auto px-6 py-4">
                <div class="flex items-center justify-between">
                    <div>
                        <h1 class="text-2xl font-bold text-slate-900">Scheduling AI</h1>
                        <p class="text-sm text-slate-500 mt-0.5">Client Matching & RBT Assignment</p>
                    </div>
                    <div class="flex items-center gap-4">
                        <div class="text-sm text-slate-600">
                            <span id="rbt-count" class="font-semibold text-slate-900">-</span>
                            <span class="text-slate-500 ml-1">RBTs Available</span>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="flex-1 flex overflow-hidden">
            <!-- Left Sidebar: Client Form & Results -->
            <aside class="w-96 bg-white border-r border-slate-200 flex flex-col shadow-lg">
                <!-- Add Client Form -->
                <div class="p-6 border-b border-slate-200 bg-gradient-to-br from-white to-slate-50">
                    <div class="flex items-center gap-2 mb-4">
                        <div class="w-8 h-8 rounded-lg bg-rise-orange/10 flex items-center justify-center">
                            <span class="text-rise-orange text-lg">âž•</span>
                        </div>
                        <h2 class="text-lg font-semibold text-slate-900">Add Client</h2>
                    </div>
                    <form id="client-form" class="space-y-4">
                        <div>
                            <label class="block text-xs font-medium text-slate-700 mb-1.5 uppercase tracking-wide">Name *</label>
                            <input type="text" id="client-name" required
                                   class="w-full px-4 py-2.5 text-sm border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-rise-orange/20 focus:border-rise-orange transition-all shadow-sm"
                                   placeholder="Enter client name">
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-slate-700 mb-1.5 uppercase tracking-wide">Address *</label>
                            <input type="text" id="client-address" required
                                   class="w-full px-4 py-2.5 text-sm border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-rise-orange/20 focus:border-rise-orange transition-all shadow-sm"
                                   placeholder="Street address">
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-slate-700 mb-1.5 uppercase tracking-wide">Zip Code *</label>
                            <input type="text" id="client-zip" required
                                   class="w-full px-4 py-2.5 text-sm border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-rise-orange/20 focus:border-rise-orange transition-all shadow-sm"
                                   placeholder="Zip code">
                        </div>
                        <button type="submit" id="add-client-btn" 
                                class="w-full px-4 py-2.5 text-sm font-semibold text-white bg-gradient-to-r from-rise-orange to-rise-orange-dark rounded-lg hover:shadow-md transition-all">
                            âž• Add Client
                        </button>
                    </form>
                </div>

                <!-- Simulation Section -->
                <div class="p-6 border-b border-slate-200 bg-gradient-to-br from-white to-slate-50">
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex items-center gap-2">
                            <div class="w-8 h-8 rounded-lg bg-blue-50 flex items-center justify-center">
                                <span class="text-blue-600 text-lg">ðŸŽ¯</span>
                            </div>
                            <h2 class="text-lg font-semibold text-slate-900">Simulation</h2>
                        </div>
                    </div>
                    <button onclick="runSimulation()" id="run-simulation-btn"
                            class="w-full px-4 py-2.5 text-sm font-semibold text-white bg-gradient-to-r from-blue-600 to-blue-700 rounded-lg hover:shadow-md transition-all">
                        â–¶ Run Simulation
                    </button>
                    <div id="simulation-status" class="text-xs text-slate-600 mt-3 min-h-[20px]"></div>
                </div>

                <!-- Tab Navigation -->
                <div class="flex border-b border-slate-200 bg-white">
                    <button onclick="switchResultsTab('current')" id="tab-current" 
                            class="flex-1 px-4 py-3 text-sm font-medium text-slate-700 bg-white border-b-2 border-rise-orange transition-colors">
                        Current
                    </button>
                    <button onclick="switchResultsTab('history')" id="tab-history"
                            class="flex-1 px-4 py-3 text-sm font-medium text-slate-500 bg-white border-b-2 border-transparent hover:text-slate-700 transition-colors">
                        History
                    </button>
                </div>

                <!-- Results Section -->
                <div class="flex-1 overflow-y-auto p-6">
                    <div id="results-current">
                        <h2 class="text-lg font-semibold text-slate-900 mb-4">Match Results</h2>
                        <div id="results-container">
                            <div class="text-center text-slate-500 py-8">
                                <p class="text-sm">Add a client and run simulation to see matches</p>
                            </div>
                        </div>
                    </div>

                    <div id="results-history" class="hidden">
                        <div class="flex items-center justify-between mb-4">
                            <h2 class="text-lg font-semibold text-slate-900">History</h2>
                            <div class="flex gap-2">
                                <button onclick="loadHistory('approved')" class="px-3 py-1 text-xs font-medium rounded-lg bg-green-100 text-green-700 hover:bg-green-200 transition-colors">Approved</button>
                                <button onclick="loadHistory('rejected')" class="px-3 py-1 text-xs font-medium rounded-lg bg-red-100 text-red-700 hover:bg-red-200 transition-colors">Rejected</button>
                                <button onclick="loadHistory('deferred')" class="px-3 py-1 text-xs font-medium rounded-lg bg-amber-100 text-amber-700 hover:bg-amber-200 transition-colors">Deferred</button>
                                <button onclick="loadHistory('all')" class="px-3 py-1 text-xs font-medium rounded-lg bg-slate-100 text-slate-700 hover:bg-slate-200 transition-colors">All</button>
                            </div>
                        </div>
                        <div id="history-container">
                            <div class="text-center text-slate-500 py-8">
                                <p class="text-sm">No history yet</p>
                            </div>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Right: Map -->
            <main class="flex-1 flex flex-col bg-white">
                <div id="map" class="flex-1" style="min-height: 600px;"></div>
                <div class="bg-gradient-to-r from-slate-50 to-white border-t border-slate-200 px-6 py-4">
                    <div class="flex items-center gap-8 text-sm flex-wrap">
                        <span class="text-slate-700 font-semibold">Legend:</span>
                        <div class="flex items-center gap-2">
                            <span class="w-5 h-5 rounded-full bg-slate-500 shadow-sm"></span>
                            <span class="text-slate-600">RBT (Available)</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <span class="w-5 h-5 rounded-full bg-orange-500 shadow-sm"></span>
                            <span class="text-slate-600">RBT (Locked)</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <span class="w-5 h-5 rounded-full bg-rise-orange shadow-sm"></span>
                            <span class="text-slate-600">Client</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <span class="w-10 h-1 bg-green-500 rounded shadow-sm"></span>
                            <span class="text-slate-600">Match</span>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script src="app-simple.js"></script>
</body>
</html>
